<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//com.component.rabbitmqmanagement.service.dao.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.component.rabbitmqmanagement.service.dao.IApplicationDao">

    <sql id="originField">
        aid,`name`,abbrname,`desc`,pid
    </sql>

    <sql id="originFieldWithoutID">
        `name`,abbrname,`desc`,pid
    </sql>

    <sql id="allField">
       aid,`name`,abbrname,`desc`,pid
    </sql>

    <sql id="tablename">
        application
    </sql>

    <select id="getAll" resultType="com.component.rabbitmqmanagement.service.entity.Application">
        SELECT a.aid as aid, a.`name` as `name`,a.abbrname as abbrname,a.`desc` as `desc`,a.pid as pid,b.`name` as productLineName,b.abbrname as productLineAbbrname
        FROM `application` a LEFT JOIN productline b on a.pid = b.pid
    </select>

    <select id="getById" resultType="com.component.rabbitmqmanagement.service.entity.Application">
        SELECT a.aid as aid, a.`name` as `name`,a.abbrname as abbrname,a.`desc` as `desc`,a.pid as pid,b.`name` as productLineName,b.abbrname as productLineAbbrname
        FROM `application` a LEFT JOIN productline b on a.pid = b.pid where a.aid = #{id}
    </select>

    <insert id="insertApplication" parameterType="com.component.rabbitmqmanagement.service.entity.Application">
        insert into<include refid="tablename"/>(<include refid="originFieldWithoutID"/>)
        VALUES (#{name},#{abbrname},#{desc},#{pid})
    </insert>

    <delete id="deleteById">
        DELETE FROM
        <include refid="tablename"/>
        where aid = #{id}
    </delete>

    <update id="update" parameterType="com.component.rabbitmqmanagement.service.entity.Application">
        update
        <include refid="tablename"/>
        SET `name`=#{name},abbrname=#{abbrname},`desc`=#{desc},pid=#{pid}
        where aid = #{aid}
    </update>

    <select id="getByNameAndPid" parameterType="com.component.rabbitmqmanagement.service.entity.Application"
            resultType="com.component.rabbitmqmanagement.service.entity.Application">
        SELECT a.aid as aid, a.`name` as `name`,a.abbrname as abbrname,a.`desc` as `desc`,a.pid as pid,b.`name` as productLineName,b.abbrname as productLineAbbrname
        FROM `application` a LEFT JOIN productline b on a.pid = b.pid where a.`name` = #{name} and a.abbrname = #{abbrname} and a.pid = #{pid}
    </select>

</mapper>